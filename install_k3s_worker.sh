#!/bin/bash

echo "β–¶οΈ k3s μ›μ»¤ λ…Έλ“ μ„¤μΉ λ° λ§μ¤ν„° ν΄λ¬μ¤ν„° μ—°κ²° μ¤ν¬λ¦½νΈ (ν† ν° μ§μ ‘ μ…λ ¥ λ°©μ‹)"
echo ""

read -p "λ§μ¤ν„° μ„λ²„μ IPλ¥Ό μ…λ ¥ν•μ„Έμ”: " MASTER_IP
read -p "λ§μ¤ν„°μ—μ„ λ³µμ‚¬ν• λ…Έλ“ ν† ν°μ„ λ¶™μ—¬λ„£μΌμ„Έμ”: " TOKEN

if [ -z "$TOKEN" ]; then
  echo "β ν† ν°μ΄ λΉ„μ–΄ μμµλ‹λ‹¤. λ§μ¤ν„°μ—μ„ ν† ν°μ„ λ³µμ‚¬ν• ν›„ λ‹¤μ‹ μ‹¤ν–‰ν•΄μ£Όμ„Έμ”."
  exit 1
fi

echo ""
echo "[1/2] k3s μ—μ΄μ „νΈ μ„¤μΉ μ¤‘..."
curl -sfL https://get.k3s.io | K3S_URL=https://$MASTER_IP:6443 K3S_TOKEN=$TOKEN sh -

echo ""
echo "[2/2] μ„λΉ„μ¤ μƒνƒ ν™•μΈ:"
systemctl status k3s-agent --no-pager

echo ""
echo "β… μ›μ»¤ λ…Έλ“κ°€ λ§μ¤ν„°μ— μ •μƒμ μΌλ΅ μ΅°μΈλμ—μµλ‹λ‹¤."
echo "π” λ§μ¤ν„°μ—μ„ 'kubectl get nodes'λ΅ λ“±λ΅ μ—¬λ¶€λ¥Ό ν™•μΈν•μ„Έμ”."
echo "β οΈ μ„¤μΉ ν›„ λ§μ¤ν„°μ—μ„ 'kubectl get nodes' λ…λ Ήμ–΄λ΅ λ…Έλ“ μƒνƒλ¥Ό ν™•μΈν•μ„Έμ”."